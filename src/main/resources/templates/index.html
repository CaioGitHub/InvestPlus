<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Investimentos</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<div class="page-bg">
    <div class="container">
        <header class="header">
            <div class="title">Investimentos</div>
            <nav class="tabs">
                <a th:href="@{/investimentos/acoes}" th:classappend="${categoria} == 'acoes' ? 'active' : ''">A√ß√µes</a>
                <a th:href="@{/investimentos/fiis}" th:classappend="${categoria} == 'fiis' ? 'active' : ''">FIIs</a>
                <a th:href="@{/investimentos/favoritos}" th:classappend="${categoria} == 'favoritos' ? 'active' : ''">Meus Favoritos</a>
            </nav>
        </header>

        <form id="searchSortForm" class="controls" method="get" th:action="@{/investimentos/{categoria}(categoria=${categoria})}">
            <div class="search-row">
                <div class="search-input-wrapper">
                    <input class="codigo-input" type="text" name="codigo" placeholder="Pesquisar por c√≥digo (ex: PETR4)"
                           th:value="${codigo != null ? codigo : ''}" />
                    <button class="search-btn" type="submit" aria-label="Buscar">üîç</button>
                </div>
            </div>

            <div class="sort-row">
                <div class="label">Ordenar por:</div>

                <div class="toggle-group" role="tablist" aria-label="Ordenar por">
                    <button type="button" class="pill pill-selected" data-sort="name">Nome</button>
                    <button type="button" class="pill" data-sort="close">Pre√ßo</button>
                </div>

                <div class="label">Dire√ß√£o:</div>
                <div class="toggle-group" role="tablist" aria-label="Dire√ß√£o">
                    <button type="button" class="pill pill-selected" data-dir="asc">Crescente</button>
                    <button type="button" class="pill" data-dir="desc">Decrescente</button>
                </div>
            </div>

            <div class="apply-row">
                <input type="hidden" name="sort" id="sortInput" th:value="${sort != null ? sort : 'name'}" />
                <input type="hidden" name="dir" id="dirInput" th:value="${dir != null ? dir : 'asc'}" />
                <input type="hidden" name="page" id="pageInput" th:value="${page}" />

                <button type="button" id="applyFiltersBtn" class="apply-filters">Aplicar Filtros</button>
            </div>
        </form>

        <section class="list-section" aria-live="polite">
            <div class="item" th:each="ativo : ${ativos}" tabindex="0">
                <div class="left">
                    <img th:if="${ativo.logo != null}" th:src="${ativo.logo}" alt="logo"
                         class="logo" />
                    <div class="meta">
                        <strong th:text="${ativo.stock}">ABCD3</strong>
                        <small th:text="${ativo.name}">Nome da empresa</small>
                        <div class="price" th:if="${ativo.close != null}">Pre√ßo: <span th:text="${ativo.close}">0.00</span></div>
                    </div>
                </div>

                <button
                        class="fav-btn"
                        th:data-symbol="${ativo.stock}"
                        th:data-name="${ativo.name != null ? ativo.name : ''}"
                        th:data-category="${ativo.type != null ? ativo.type : categoria}"
                        th:text="${observadoSymbols.contains(ativo.stock) ? '-' : '+'}">
                </button>
            </div>
        </section>

        <div class="pager">
            <a th:classappend="${page <= 1} ? 'disabled' : ''"
               th:if="${page > 1}"
               th:href="@{/investimentos/{categoria}(categoria=${categoria},page=${page-1},sort=${sort},dir=${dir})}">‚Äπ</a>

            <span>Pagina <strong th:text="${page}">1</strong> de <strong th:text="${totalPages}">1</strong></span>

            <a th:classappend="${page >= totalPages} ? 'disabled' : ''"
               th:if="${page < totalPages}"
               th:href="@{/investimentos/{categoria}(categoria=${categoria},page=${page+1},sort=${sort},dir=${dir})}">‚Ä∫</a>
        </div>
    </div>
</div>

<script src="/js/scripts.js"></script>
</body>
</html>
